SELECT COUNT(*), person_id 
FROM (
    SELECT person_id, event_id, world_rank
    FROM ranks_average
    WHERE event_id IN ('333', '222', '444', '555', '666', '777', 'pyram', 'sq1', 'skewb', 'minx', 'clock', '333fm', '333oh')
    UNION
    SELECT person_id, event_id, world_rank
    FROM ranks_single
    WHERE event_id IN ('333bf', '444bf', '555bf', '333mbf')
) top_players
WHERE world_rank < 26
GROUP BY person_id
ORDER BY COUNT(*) DESC, person_id
